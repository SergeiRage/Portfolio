# Изучение причин оттока клиентов банка
Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. 

Источник данных: [https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling](https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling)

# Цель исследования

Цель проекта заключается в построении модели, позволяющей спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Для выполнения цели необходимо решить следующие задачи:

Проанализировать основную информацию о клиентах банка.
Подготовить данные для построения моделей.
Обучить модели и по показателям определить наилучшую.
Провести тестирование модели на выборке.

# Выводы

Мной был рассмотрен датасет с данными клиентов банка. В датасете 10000 объектов,которые оторые содержат такие показатели, как возраст, количество средств, активность, зарплата, а также фиксируется факт ухода клиента из банка. Имевшиеся пропуски в колонке Tenure я заполнил медианным значением, а также изменил тип данных на int, явных дубликатов нет в данных нет. Удалены из датасета след.колонки RowNumber, CustomerId, Surname. Наименования колонок приведены к принятому стилю.

В первоначальные данных наблюдался значительный дисбаланс (80% ответов целевого признака были негативными и только 20% позитивными), из-за чего обученная на этих данных модель не проходила проверку на адекватность. Все модели не первоначальных данных характеризовались высокой степенью ошибок и низким качеством взвешенной величины (F1) — модели показывали низкие результаты точности и полноты.

Устранил дисбаланс классов путем увеличения количества значений позитивного класса в 4 раза.

Применил варианты борьбы с дисбалансом классов upsampling и downsampling.

На новых данных все модели показали результат выше, чем на несбалансированной выборке. Лучшие показатели были у модели случайного леса при увеличении выборки F1 - 0,61 AUC-ROC - 0,858, что также подтверждается графиком ROC-кривой:

Precision 0.5746887966804979 Recall 0.6533018867924528 F1 0.6114790286975716 AUC-ROC = 0.8584613842064936

Финальная модель прошла проверку на адекватность в сравнении с контантной моделью:

accuracy_score константой модели: 0.788 accuracy_score финальной модели: 0.823 AUC-ROC константой модели: 0.5 AUC-ROC финальной модели: 0.8595490714134782

Соответственно, модель случайного леса, обкченная на сбалансированной выборке может быть использована для определения потенциальных клиентов, которые собираются "покинуть" банк. Модель характеризуется нормальным показателем полноты = 0.65 (min = 0, max = 1), поэтому она с высокой вероятностью предскажит уход клиента из банка. Но необходимо отметить, что точность модели немногоим более 50, поэтому многие клиенты будут восприняты ошибочно, как собирающиеся разорвать отношения с банком. Это надо учитывать при подборе индивидуальных предложений для клиентов.
